<!DOCTYPE html><html><head>
      <title>README</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\agrawa3\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.18\crossnote\dependencies\katex\katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="fraud-detection-method"><strong>Fraud Detection Method</strong> </h1>
<ul>
<li><a href="#before-you-begin">Before you begin</a></li>
<li><a href="#set-up-parameters">Set up parameters</a>
<ul>
<li><a href="#sheet-1-filepaths">Sheet 1: <code>filepaths</code></a></li>
<li><a href="#sheet-2-flags">Sheet 2: <code>flags</code></a></li>
<li><a href="#sheet-3-initial_classification_rules">Sheet 3: <code>initial_classification_rules</code></a></li>
<li><a href="#sheet-4-final_classification_rules">Sheet 4: <code>final_classification_rules</code></a></li>
</ul>
</li>
<li><a href="#fraud-detection">Fraud detection</a>
<ul>
<li><a href="#step-1-initial-classification">Step 1: Initial classification</a></li>
<li><a href="#step-2-get-descriptive-statistics-and-generate-plots-optional">Step 2: Get descriptive statistics and generate plots (Optional)</a></li>
<li><a href="#step-3-manual-classification">Step 3: Manual classification</a></li>
<li><a href="#step-4-final-classification">Step 4: Final classification</a></li>
<li><a href="#step-5-get-descriptive-statistics-and-generate-plots-optional">Step 5: Get descriptive statistics and generate plots (Optional)</a></li>
</ul>
</li>
<li><a href="#optional-tool-fuzzy-string-matching-tool">Optional Tool: Fuzzy String Matching Tool</a>
<ul>
<li><a href="#sheet-5-fuzzy_string">Sheet 5: <code>fuzzy_string</code></a></li>
</ul>
</li>
</ul>
<h1 id="before-you-begin">Before you begin </h1>
<ul>
<li>Verify the folder structure</li>
</ul>
<pre data-role="codeBlock" data-info="text" class="language-text text"><code>.
├── config/
    ├── parameters.xlsx # Parameters file. Requires user input.
    └── world-administrative-boundaries # Optional shape file to get country from latitude-longitude
        ├── world-administrative-boundaries.cpg
        ├── world-administrative-boundaries.dbf
        ├── world-administrative-boundaries.prj
        ├── world-administrative-boundaries.shp # Shape file. File path in parameters.xlsx.
        ├── world-administrative-boundaries.shx
        └── world-administrative-boundaries-countries.txt # List of country names
├── data/ # Data folder for base files and generated files. 
    └── sample_data.csv
├── 01_initial_classification.py
├── 02_get_initial_descriptives.py
├── 04_final_classification.py
├── 05_get_final_descriptives.py
├── README.md
└── fraud_detection.py # Contains implemented methods.
</code></pre><ul>
<li>Install <a href="https://www.python.org/downloads/release/python-3129/">Python-3.12.9</a>. Newer verions may work as well.</li>
</ul>
<p><em>For Windows users:</em></p>
<ul>
<li>Open command prompt</li>
<li>[Optional] Set up a virtual environment to avoid version conflicts.
<ul>
<li>Navigate to the project folder: <code>cd \path\to\spam-detection</code></li>
<li>Create a virtual environment: <code>python -m venv myvenv</code></li>
<li>Activate the virtual environment: <code>myvenv\Scripts\activate</code></li>
</ul>
</li>
<li>Install required Python modules: <code>pip install -r \path\to\requirements.txt</code></li>
</ul>
<h1 id="set-up-parameters">Set up parameters </h1>
<ul>
<li>Ensure that <code>parameters.xlsx</code> exists in the <code>config</code> folder. This file should contain the following four sheets:</li>
</ul>
<h2 id="sheet-1-filepaths">Sheet 1: <code>filepaths</code> </h2>
<p>Specifies paths for files and folder. This sheet contains three columns:</p>
<ul>
<li>
<p>🚫 <strong>[DO NOT EDIT]</strong> <code>parameter</code>: Variable names used to refer specific file or folder.</p>
</li>
<li>
<p>✏️ <strong>[EDIT / REVIEW]</strong> <code>value</code>: Path of corresponding <code>parameter</code>. The <code>value</code> for the <code>data_file</code> parameter must be changed to the survey data filepath.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>description</code>: Description of corresponding <code>parameter</code>.</p>
</li>
</ul>
<h2 id="sheet-2-flags">Sheet 2: <code>flags</code> </h2>
<p>Contains details of flags used for automated fraud detection. Each row specifies one flag. This sheet contains six columns:</p>
<ul>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>flag_name</code>: Name of the flag. We recommend using the convention <code>F_FlagName</code>.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>method_name</code> Name of the method used. Must match the method name implemented in <code>fraud_detection.py</code>. See <code>docs</code> for more details.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>flag_group</code>: Name of the flag group. We recommend using the convention <code>FG_FlagGroupName</code>.</p>
</li>
<li>
<p>✏️ <strong>[EDIT / REVIEW]</strong> <code>use_flag</code>: Indicator for using the flag (<code>1</code>) or not (<code>0</code>).</p>
</li>
<li>
<p>✏️ <strong>[EDIT / REVIEW]</strong> <code>parameters</code>: Flag-specific paramters that are required by the corresponding method. See <code>docs</code> for more details.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>description</code>: A brief description of the flag. Optional.</p>
</li>
</ul>
<h2 id="sheet-3-initial_classification_rules">Sheet 3: <code>initial_classification_rules</code> </h2>
<p>Contains a sequence of top-down rules to classify responses based on flag groups. Once a rule is satisfied, the response is assigned the corresponding classification, and no subsequent rules are evaluated. This sheet contains four columns:</p>
<ul>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>rule_num</code>: Rule number. Optional.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>condition_expr</code>: An expression for the Boolean condition using flag groups. The expression is evaluated using Python's <a href="https://docs.python.org/3/library/functions.html#eval"><code>eval()</code></a>. The evaluation of the expression must return either <code>True</code> or <code>False</code>.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>classification</code>: Response classification label.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>use_rule</code>: Indicator for using the rule (<code>1</code>) or not (<code>0</code>).</p>
</li>
</ul>
<h2 id="sheet-4-final_classification_rules">Sheet 4: <code>final_classification_rules</code> </h2>
<p>Contains a sequence of top-down rules to classify responses combining automated and manual classification. Once a rule is satisfied, the response is assigned the corresponding classification, and no subsequent rules are evaluated. This sheet contains four columns:</p>
<ul>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>rule_num</code>: Rule number. Optional.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>condition_expr</code>: An expression for the Boolean condition using <code>FLAG</code> and <code>MANUAL_FLAG</code> columns. The expression is evaluated using Python's <a href="https://docs.python.org/3/library/functions.html#eval"><code>eval()</code></a>. The evaluation of the expression must return either <code>True</code> or <code>False</code>.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>classification</code>: Response classification label.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>use_rule</code>: Indicator for using the rule (<code>1</code>) or not (<code>0</code>).</p>
</li>
</ul>
<h1 id="fraud-detection">Fraud detection </h1>
<p>❗ <strong>IMPORTANT: We strongly recommend executing the scripts via the command line</strong>.</p>
<p><em>For Windows users:</em></p>
<ul>
<li>Open command prompt (Windows)
<ul>
<li>Navigate to the project folder: <code>cd \path\to\spam-detection</code></li>
<li>Execute the script: <code>python script_name.py</code> (e.g., <code>python 02_get_initial_descriptives.py</code>)</li>
</ul>
</li>
</ul>
<h2 id="step-1-initial-classification">Step 1: Initial classification </h2>
<p>Execute <code>01_initial_classification.py</code> to generate an output file with automated response classification.</p>
<p>The output file path is the value of <code>flagged_file</code> in the <code>filepaths</code> sheet of <code>parameters.xlsx</code>. The output file will contain:</p>
<ul>
<li>The original survey data columns.</li>
<li>Columns corresponding to each flag indicating TRUE or FLASE. Some additional columns corresponding to specific methods may also be created.</li>
<li>Columns corresponding to each flag group with the number of corresponding flags activated.</li>
<li>The automated response classification column <code>FLAG</code>.</li>
<li>Placeholder columns for manual classification by the user <code>MANUAL_FLAG</code> and <code>MANUAL_COMMENT</code>.</li>
</ul>
<h2 id="step-2-get-descriptive-statistics-and-generate-plots-optional">Step 2: Get descriptive statistics and generate plots (Optional) </h2>
<p>Execute <code>02_get_initial_descriptives.py</code> to print descriptive statistics (such as counts) for the flags and flag groups and to generate co-occurence plots for diagnostic purposes.</p>
<ul>
<li>If provided, the plots are saved in the <code>figure_folder</code> folder provided in the <code>filepaths</code> sheet of <code>parameters.xlsx</code>.</li>
</ul>
<h2 id="step-3-manual-classification">Step 3: Manual classification </h2>
<p>This step involves user to manually classify the responses, especially the ones marked as <code>TBD</code> in the <code>FLAG</code> column during automated classification.</p>
<p>Manual classification can be done in the <code>flagged_file</code> itself. However, a <code>manual_file</code> path can be set in the <code>filepaths</code> sheet of <code>parameters.xlsx</code> if the file is copied before manual classification.</p>
<ul>
<li>The <code>MANUAL_FLAG</code> entered by the user are used to evaluate the <code>condition_expr</code> in the <code>final_classification_rules</code> sheet of <code>parameters.xlsx</code>.</li>
<li><code>MANUAL_COMMENT</code> is an optional column to add information justfying the manual classification.</li>
</ul>
<h2 id="step-4-final-classification">Step 4: Final classification </h2>
<p>Execute <code>04_final_classification.py</code> to generate an output file that combines automated and manual classifications.</p>
<p>The output file path is the value of <code>final_output_file</code> in the <code>filepaths</code> sheet of <code>parameters.xlsx</code>. The output file will contain:</p>
<ul>
<li>All columns in <code>manual_file</code>.</li>
<li>A final classification column <code>FINAL_FLAG</code>.</li>
</ul>
<h2 id="step-5-get-descriptive-statistics-and-generate-plots-optional">Step 5: Get descriptive statistics and generate plots (Optional) </h2>
<p>Execute <code>05_get_final_descriptives.py</code> to print descriptive statistics (such as counts) for the flags and flag groups and to generate co-occurence plots for diagnostic purposes.</p>
<p>If <code>figure_folder</code> value provided in the <code>filepaths</code> sheet of <code>parameters.xlsx</code>, the plots are saved in the <code>figure_folder</code> folder.</p>
<h1 id="optional-tool-fuzzy-string-matching-tool">Optional Tool: Fuzzy String Matching Tool </h1>
<p>This fuzzy string matching tool compares each text responses within a column and computes a similarity score (ranging from 0 and 100) based on the presence and frequency of shared words. Two columns are added to the dataframe:</p>
<ul>
<li><code>FZ_COUNT_{column}</code>: Number of similar responses(score &gt; set threshold), and</li>
<li><code>FZ_SIMILAR_{column}</code>: Score and text of similar responses.</li>
</ul>
<p>This tool is particularly useful for larger samples as it provides an easy reference for closer inspection during manual review. It can also be implemented as a custom flag.</p>
<p>To use this tool,</p>
<ul>
<li>Install <code>rapidfuzz</code> v3.13 module using: <code>pip install rapidfuzz==3.13.0</code></li>
<li>Verify that <code>fuzzy_string</code> sheet exists in <code>parameters.xlsx</code>.</li>
<li>Verify that a value for the paramter <code>fuzzy_file</code> is provided in the <code>filepaths</code> sheet in <code>parameters.xlsx</code>.
<ul>
<li>If using this tool with automated response classification, set <code>fuzzy_file</code> same as <code>data_file</code> and run the <code>tool_mark_similar_responses.py</code> before <code>01_initial_classification.py</code>.</li>
<li>If using this tool after automated response classification but before manual classification, set <code>fuzzy_file</code> same as <code>flagged_file</code> and run the <code>tool_mark_similar_responses.py</code> before manually classifying the data.</li>
</ul>
</li>
</ul>
<h2 id="sheet-5-fuzzy_string">Sheet 5: <code>fuzzy_string</code> </h2>
<p>Contains information about text-response columns on which fuzzy string algorithm should be applied. Each row specifies one text-response column. This sheet contains six columns:</p>
<ul>
<li>
<p>✏️ <strong>[EDIT / REVIEW]</strong>  <code>column</code>: Data column name to check for similar resppnses.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>minimum_length</code>: The minimum number of characters a text response should have to be tested for similarity. Responses having lesser number of characters will be ignored. This is useful to ignore comparing common short and valid responses like "Nothing", "None", or any context-dependent short responses.</p>
</li>
<li>
<p>🚫 <strong>[DO NOT EDIT]</strong> <code>fuzzy_algorithm</code>: Fuzzy string matching llgorithm used for comparing responses. We recommend using <code>token_sort_ratio</code> as it considers both the presence and the frequency of words. For more details, please see the <a href="https://rapidfuzz.github.io/RapidFuzz/Usage/fuzz.html"><code>rapidfuzz</code> documentation</a>.</p>
</li>
<li>
<p>🔧 <strong>[OPTIONAL EDIT]</strong> <code>threshold</code>: Threshold to mark similar responses. Defaults to 65. This should be changed based on trial and error.</p>
</li>
</ul>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>